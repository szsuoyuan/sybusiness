function getRandomNum(){function e(e,n){if(0==n.length)return!0;for(var t=0;t<n.length;t++)return e==n[t]?!1:!0}function n(){o=Math.floor(10*Math.random()),e(o,a)?(i+=t[o],a.push(o)):n()}for(var t=[0,1,2,3,4,5,6,7,8,9],o=null,a=[],i="",l=0;6>l;l++)n();return i}$(function(){function e(){w=$("#RYQM").val(),""==w&&(w="0000000"),$.ajax({url:ApiUrl+"/index.php?act=member_login&op=check_code&client_type=wap&code="+w,type:"get",dataType:"jsonp",jsonp:"callback",success:function(e){200!=e.code?((new Win).newalert2(e.message),p=0):p=1,i()}})}function n(){var e=$("#smsBtn"),n=$("#voIpBtn");r=$("#RTel").val(),isNaN(r)?((new Win).newalert2("请输入数字"),m.removeClass("on"),e.unbind(),n.unbind(),u=0):11==r.length?$.ajax({url:ApiUrl+"/index.php?act=member_login&op=check_mobile&client_type=wap&mobile="+r,type:"get",dataType:"jsonp",jsonp:"callback",success:function(t){200!=t.code?((new Win).newalert2(t.message),m.removeClass("on"),e.unbind(),n.unbind(),u=0):(m.addClass("on"),e.unbind().on("click",function(){o(0)}),n.unbind().on("click",function(){o(1)}),u=1,i())}}):(m.removeClass("on"),e.unbind(),n.unbind(),u=0)}function t(){return s=$("#password").val(),!s.trim()||s.length<6||s.length>15?((new Win).newalert2("请设置6-20位密码"),!1):!0}function o(e){m.hide(),f.css("display","table-cell"),$("#RTel").attr("readonly","readonly").css("color","#ccc");var n=60,t=setInterval(function(){0==n?(clearInterval(t),f.hide().html("<a>60秒</a>"),m.css("display","table-cell"),$("#RTel").removeAttr("readonly").css("color","#333")):(n-=1,f.html("<a>"+n+"秒</a>"))},1e3);$.ajax({url:ApiUrl+"/index.php?act=member_login&op=send_verify_code&client_type=wap&user_type=0&verify_type="+e+"&&mobile="+r,type:"get",dataType:"jsonp",jsonp:"callback",success:function(e){200!=e.code&&(new Win).newalert2(e.message)}})}function a(){c=$("#RYCode").val(),6==c.length?$.ajax({url:ApiUrl+"/index.php?act=member_login&client_type=wap&op=vertify_code&mobile="+r+"&vertify_code="+c,type:"get",dataType:"jsonp",jsonp:"callback",success:function(e){200!=e.code?(d=0,(new Win).newalert2(e.message),i()):(d=1,i())}}):(d=0,i())}function i(){1==p&&1==u&&1==d?$("#confirmBtn").addClass("on").unbind().on("click",function(){l()}):$("#confirmBtn").removeClass("on").unbind()}function l(){var e="agg_"+getRandomNum();t?$.ajax({url:ApiUrl+"/index.php?act=member_login&client_type=wap&op=register&mobile="+r+"&password="+s+"&password_confirm="+s+"&nick_name="+e+"&code="+w+"&vertify_code="+c,type:"post",dataType:"jsonp",success:function(e){200!=e.code?(new Win).newalert2(e.message):((new Win).newalert2("注册成功！3秒后跳转回登录页面！"),window.setTimeout(function(){window.location.href=WapSiteUrl+"/tmpl/member/login.html?fromRegister=1"},3e3))}}):(new Win).newalert2("请设置6-20位密码")}var c,r,s,p=1,u=0,d=0,m=$(".getYZM"),f=$(".time"),w="0000000";$("#RYQM").blur(function(){e()}),$("#RTel").keyup(function(){n()}),$("#password").blur(function(){t()}),$("#RYCode").keyup(function(){a()}),$(".see").click(function(){var e=$(this);e.hasClass("on")?(e.parent().find("input").attr("type","password"),e.removeClass("on")):(e.parent().find("input").attr("type","text"),e.addClass("on"))})});